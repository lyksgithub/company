<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.genepoint.lbsshow.dao.TrackMapper" >
	<resultMap type="com.genepoint.lbsshow.model.Track" id="TrackResultMap">
		<id column="id" property="id" jdbcType="INTEGER"/>
		<result column="mac" property="mac" jdbcType="VARCHAR"/>
		<result column="building" property="building" jdbcType="VARCHAR"/>
		<result column="floor" property="floor" jdbcType="VARCHAR"/>
		<result column="corx" property="corx" jdbcType="DOUBLE"/>
		<result column="cory" property="cory" jdbcType="DOUBLE"/>
		<result column="time" property="time" jdbcType="BIGINT"/>
		<result column="shop_id" property="shopId" jdbcType="INTEGER"/>
	</resultMap>
	
	<select id="getTrack" parameterType="com.genepoint.lbsshow.model.vo.TrackVO" resultMap="TrackResultMap">
		select corx,cory,time from ${tableName} where 
		<if test="floor != null">
		floor=#{floor} and
		</if>
		 mac=#{mac} and time between #{startTime} and #{endTime} order by time asc
	</select>

	<select id="getPersonTrack" parameterType="com.genepoint.lbsshow.model.vo.TrackVO" resultMap="TrackResultMap">
		select corx,cory,time,floor from ${tableName} where mac=#{mac} and time between #{startTime} and #{endTime} order by time asc
	</select>
	
	<select id="getTrackByFloorAndTime" parameterType="com.genepoint.lbsshow.model.vo.TrackVO" resultMap="TrackResultMap">
		select mac,corx,cory,time from ${tableName} where floor=#{floor} 
		and time between #{startTime} and #{endTime} order by time asc
	</select>
	
	<select id="getTrackByBuilding" parameterType="com.genepoint.lbsshow.model.vo.TrackVO" resultMap="TrackResultMap">
		select mac,corx,cory,time from ${tableName} where building=#{building} and floor=#{floor} 
		and  time between #{startTime} and #{endTime} order by time asc
	</select>
</mapper>